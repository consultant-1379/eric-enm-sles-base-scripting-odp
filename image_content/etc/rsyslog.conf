##
## === When you're using remote logging, enable on-disk queues ===
## === in rsyslog.d/remote.conf.                               ===
##
## Note, that when the MYSQL, PGSQL, GSSAPI, GnuTLS or SNMP modules
## (provided in separate rsyslog-module-* packages) are enabled, the
## configuration can't be used on a system with /usr on a remote
## filesystem, except on newer systems where initrd mounts /usr.
## [The modules are linked against libraries installed bellow of
##  /usr thus also installed in /usr/lib*/rsyslog because of this.]
##

#
# if you experience problems, check
# http://www.rsyslog.com/troubleshoot for assistance
# and report them at http://bugzilla.novell.com/
#

# since rsyslog v3: load input modules
# If you do not load inputs, nothing happens!

# For rsyslog be ready to create a debug log on Demand, DebugLevel is set to 1
# rsyslog waits for a USR signal to the pid. When sent, the debug output will be triggered. When sent again, debug output will be stopped.
# The USR signal is -- # kill -USR1 `cat /var/run/rsyslogd.pid`
$DebugFile /tmp/log/rsyslog.debug
$DebugLevel 1

# provides --MARK-- message capability (every 1 hour)
$ModLoad immark.so
$MarkMessagePeriod      3600

# provides support for local system logging (e.g. via logger command)
#$ModLoad imuxsock.so
module(
    load="imuxsock"
    SysSock.Use="on"
    SysSock.Name="/var/lib/eric-odp/rsyslogd/rsyslog.sock"
)

# reduce dupplicate log messages (last message repeated n times)
$RepeatedMsgReduction   on

# kernel logging (may be also provided by /sbin/klogd)
# see also http://www.rsyslog.com/doc-imklog.html.
#$ModLoad imklog.so
# set log level 1 (same as in /etc/sysconfig/syslog).
#$klogConsoleLogLevel    1

#
# Set the default permissions for all log files.
#
#$FileOwner root
#$FileGroup root
#$FileCreateMode 0640
#$DirCreateMode 0750
#$Umask 0022

# Use rsyslog native, rfc5424 conform log format as default
# ($ActionFileDefaultTemplate RSYSLOG_FileFormat).
#
# To change a single file to use obsolete BSD syslog format
# (rfc 3164, no high-precision timestamps), set the variable
# bellow or append ";RSYSLOG_FileFormat" to the filename.
# See
#   http://www.rsyslog.com/doc/rsyslog_conf_templates.html
# for more informations.
#
$ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat

#
# Include config generated by /etc/init.d/syslog script
# using the SYSLOGD_ADDITIONAL_SOCKET* variables in the
# /etc/sysconfig/syslog file.
#
#$IncludeConfig /run/rsyslog/additional-log-sockets.conf

#
# Include config files, that the admin provided? :
#
$IncludeConfig /etc/rsyslog.d/*.conf
###
# print most important on tty10 and on the xconsole pipe
#
#if      ( \
#            /* kernel up to warning except of firewall  */ \
#            ($syslogfacility-text == 'kern')      and      \
#            ($syslogseverity <= 4 /* warning */ ) and not  \
#            ($msg contains 'IN=' and $msg contains 'OUT=') \
#        ) or ( \
#            /* up to errors except of facility authpriv */ \
#            ($syslogseverity <= 3 /* errors  */ ) and not  \
#            ($syslogfacility-text == 'authpriv')           \
#        ) \
#then {
#        /dev/tty10
#        |/dev/xconsole
#}

# Log anything (except mail) of level info or higher.
# Don't log private authentication messages!
*.info;mail.none;authpriv.none;cron.none                /var/lib/eric-odp-logger/messages

# The authpriv file has restricted access.
authpriv.*                                              /var/lib/eric-odp-logger/secure

# Log all the mail messages in one place.
mail.*                                                  /var/lib/eric-odp-logger/maillog


# Log cron stuff
cron.*                                                  /var/lib/eric-odp-logger/cron

# Everybody gets emergency messages
*.emerg                                                 :omusrmsg:*

# Save news errors of level crit and higher in a special file.
uucp,news.crit                                          /var/lib/eric-odp-logger/spooler

# Save boot messages also to boot.log
local7.*                                                /var/lib/eric-odp-logger/boot.log


# enable this, if you want that root is informed
# immediately, e.g. of logins
#*.alert                                root


#
# firewall messages into separate file and stop their further processing
#
#if      ($syslogfacility-text == 'kern') and \
#        ($msg contains 'IN=' and $msg contains 'OUT=') \
#then {
#        -/var/lib/eric-odp-logger/firewall
#        stop
#}
#
# acpid messages into separate file and stop their further processing
#
# => all acpid messages for debuging (uncomment if needed):
#if     ($programname == 'acpid' or $syslogtag == '[acpid]:') then \
#       -/var/lib/eric-odp-logger/acpid
#
# => up to notice (skip info and debug)
if      ($programname == 'acpid' or $syslogtag == '[acpid]:') and \
        ($syslogseverity <= 5 /* notice */) \
then {
        -/var/lib/eric-odp-logger/acpid
        stop
}


#
# NetworkManager into separate file and stop their further processing
#
#if      ($programname == 'NetworkManager') or \
#        ($programname startswith 'nm-') \
#then {
#        -/var/lib/eric-odp-logger/NetworkManager
#        stop
#}


#
# email-messages
#
#mail.*                                  -/var/lib/eric-odp-logger/mail
#mail.info                               -/var/lib/eric-odp-logger/mail.info
#mail.warning                            -/var/lib/eric-odp-logger/mail.warn
#mail.err                                 /var/lib/eric-odp-logger/mail.err


#
# news-messages
#
#news.crit                              -/var/lib/eric-odp-logger/news/news.crit
#news.err                               -/var/lib/eric-odp-logger/news/news.err
#news.notice                            -/var/lib/eric-odp-logger/news/news.notice
# enable this, if you want to keep all news messages
# in one file
#news.*                                 -/var/lib/eric-odp-logger/news.all


#
# Warnings in one file
#
#*.=warning;*.=err                       -/var/lib/eric-odp-logger/warn
#*.crit                                   /var/lib/eric-odp-logger/warn


#
# the rest in one file
#
#*.*;mail.none;news.none                 -/var/lib/eric-odp-logger/messages

#
# enable this, if you want to keep all messages
# in one file
#*.*                                    -/var/lib/eric-odp-logger/allmessages


#
# Some foreign boot scripts require local7
#
#local0.*;local1.*                       -/var/lib/eric-odp-logger/localmessages
#local2.*;local3.*                       -/var/lib/eric-odp-logger/localmessages
#local4.*;local5.*                       -/var/lib/eric-odp-logger/localmessages
#local6.*;local7.*                       -/var/lib/eric-odp-logger/localmessages

###